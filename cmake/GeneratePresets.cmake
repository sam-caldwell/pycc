cmake_minimum_required(VERSION 3.25)

# Generate a simple CMakePresets.json with default and lint presets
file(WRITE ${CMAKE_SOURCE_DIR}/CMakePresets.json "{\n  \"version\": 4,\n  \"cmakeMinimumRequired\": { \"major\": 3, \"minor\": 25, \"patch\": 0 },\n  \"configurePresets\": [\n    {\n      \"name\": \"default\",\n      \"displayName\": \"Default (Debug)\",\n      \"generator\": \"Ninja\",\n      \"binaryDir\": \"build\",\n      \"cacheVariables\": {\n        \"CMAKE_C_COMPILER\": \"${env.CC}\",\n        \"CMAKE_CXX_COMPILER\": \"${env.CXX}\",\n        \"CMAKE_BUILD_TYPE\": \"Debug\",\n        \"PYCC_EMIT_LLVM\": \"ON\",\n        \"PYCC_EMIT_ASM\": \"ON\"\n      }\n    },\n    {\n      \"name\": \"lint\",\n      \"displayName\": \"Lint\",\n      \"inherits\": \"default\",\n      \"binaryDir\": \"build-lint\",\n      \"cacheVariables\": {\n        \"PYCC_ENABLE_TIDY\": \"ON\",\n        \"PYCC_REQUIRE_TIDY_PLUGIN\": \"OFF\"\n      }\n    }\n  ],\n  \"buildPresets\": [\n    { \"name\": \"default\", \"configurePreset\": \"default\" },\n    { \"name\": \"lint\",    \"configurePreset\": \"lint\" }\n  ],\n  \"testPresets\": [\n    { \"name\": \"default\", \"configurePreset\": \"default\" }\n  ]\n}\n")

message(STATUS "Generated CMakePresets.json")
